(()=>{function n(){$.ajax({headers:{Authorization:"Bearer "+window.api_token},url:"/api/messages",type:"GET",data:{offset:window.offset,limit:5},success:function(n){window.offset>=n.count||($(".add_like").unbind(),$(".favorite").unbind(),$("#messages").append(),window.offset+=5,this.data=n,$.each(this.data.data,(function(n,i){$("#messages").append('\n                <div class="mt-8 bg-white dark:bg-gray-800 overflow-hidden shadow sm:rounded-lg">\n                    <div class="message">\n                        <div class="items-center">\n                            <div class="ml-4 text-lg leading-7 font-semibold">'.concat(i.user.name,'</div>\n                        </div>\n\n                        <div class="ml-12">\n                            <div class="mt-2">').concat(i.text,'\n                                <div>\n                                    <img src="/').concat(i.image,'" alt="">\n                                </div>\n                            </div>\n                        </div>\n                    </div>\n\n                    <div class="grid-container">\n                            <div class="grid-item">\n                                <link href="https://fonts.googleapis.com/css2?family=Cookie&display=swap" rel="stylesheet">\n                                <button id="btn" class="add_like" type="button" data-id="').concat(i.id,'">\n                                <span class="noselect">').concat(i.likes_count,'</span>\n                                <div id="circle"></div>\n                                </button>\n                            </div>\n                            <div class="grid-item">\n                                <link href="https://fonts.googleapis.com/css2?family=Cookie&display=swap" rel="stylesheet">\n                                <button id="btn" class="favorite" type="button" data-id="').concat(i.id,'">\n                                <span class="noselect">').concat(t(i.id),'</span>\n                                <div id="circle"></div>\n                                </button>\n                            </div>\n                        </div>\n                </div>\n                    '))})),$(".add_like").on("click",(function(){!function(n,t){$.ajax({headers:{Authorization:"Bearer "+window.api_token},url:"/api/messages/like/add",method:"post",data:JSON.stringify({message_id:n}),contentType:"application/json",cache:!1,processData:!1,success:function(n){t.html(n.likes_count)}}).done((function(n){}))}($(this).data().id,$(this))})),$(".favorite").on("click",(function(){var n=$(this).data().id;!function(n){var t="is_msg_favorite_"+n;if(!localStorage[t])return void(localStorage[t]=1);delete localStorage[t]}(n),$(this).html(t(n))})))}})}function t(n){return localStorage["is_msg_favorite_"+n]?"Из избранного":"В избранное"}$("#addMessage").on("submit",(function(t){t.preventDefault(),form=$(this)[0],$.ajax({headers:{Authorization:"Bearer "+window.api_token},url:$(this).attr("action"),method:"post",data:new FormData(form),cache:!1,processData:!1,contentType:!1,success:function(){form.reset(),n()}})})),$(document).ready((function(t){window.offset=0,n(),t(window).scroll((function(){console.log("\n        $(window).scrollTop() >= ($(document).height() - $(window).height()) = ".concat(t(window).scrollTop()>=t(document).height()-t(window).height(),"\n        $(window).scrollTop() = ").concat(t(window).scrollTop(),"\n        $(document).height() - $(window).height()) = ").concat(t(document).height()-t(window).height(),"\n        $(window).height() = ").concat(t(window).height(),"\n        $(document).height() = ").concat(t(document).height(),"\n\n        ")),t(window).scrollTop()>=t(document).height()-t(window).height()-1&&n()}))}))})();