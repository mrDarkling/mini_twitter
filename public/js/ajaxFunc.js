(()=>{function t(){$.ajax({headers:{Authorization:"Bearer "+window.api_token},url:"/api/messages",type:"GET",data:{offset:window.offset,limit:5},success:function(t){window.offset>=t.count||($(".add_like").unbind(),$(".favorite").unbind(),$("#messages").append(),window.offset+=5,this.data=t,$.each(this.data.data,(function(t,i){$("#messages").append('\n                <div class="mt-8 bg-white dark:bg-gray-800 overflow-hidden shadow sm:rounded-lg">\n                    <div class="message">\n                        <div class="items-center">\n                            <div class="ml-4 text-lg leading-7 font-semibold">'.concat(i.user.name,'</div>\n                        </div>\n\n                        <div class="ml-12">\n                            <div class="mt-2">').concat(i.text,'\n                                <div>\n                                    <img src="/').concat(i.image,'" alt="">\n                                </div>\n                            </div>\n                        </div>\n                    </div>\n\n                    <div class="grid-container">\n                            <div class="grid-item">\n                                <link href="https://fonts.googleapis.com/css2?family=Cookie&display=swap" rel="stylesheet">\n                                <button id="btn" class="add_like" type="button" data-id="').concat(i.id,'">\n                                <span class="noselect">').concat(i.likes_count,'</span>\n                                <div id="circle"></div>\n                                </button>\n                            </div>\n                            <div class="grid-item">\n                                <link href="https://fonts.googleapis.com/css2?family=Cookie&display=swap" rel="stylesheet">\n                                <button id="btn" class="favorite" type="button" data-id="').concat(i.id,'">\n                                <span class="noselect">').concat(n(i.id),'</span>\n                                <div id="circle"></div>\n                                </button>\n                            </div>\n                        </div>\n                </div>\n                    '))})),$(".add_like").on("click",(function(){!function(t,n){$.ajax({headers:{Authorization:"Bearer "+window.api_token},url:"/api/messages/like/add",method:"post",data:JSON.stringify({message_id:t}),contentType:"application/json",cache:!1,processData:!1,success:function(t){n.html(t.likes_count)}}).done((function(t){}))}($(this).data().id,$(this))})),$(".favorite").on("click",(function(){var t=$(this).data().id;!function(t){var n="is_msg_favorite_"+t;if(!localStorage[n])return void(localStorage[n]=1);delete localStorage[n]}(t),$(this).html(n(t))})))}})}function n(t){return localStorage["is_msg_favorite_"+t]?"Из избранного":"В избранное"}$("#addMessage").on("submit",(function(n){n.preventDefault(),form=$(this)[0],$.ajax({headers:{Authorization:"Bearer "+window.api_token},url:$(this).attr("action"),method:"post",data:new FormData(form),cache:!1,processData:!1,contentType:!1,success:function(){form.reset(),t()}})})),$(document).ready((function(n){window.offset=0,t(),n(window).scroll((function(){n(window).scrollTop()===n(document).height()-n(window).height()&&t()}))}))})();